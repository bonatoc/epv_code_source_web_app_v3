<ion-view view-title="Productfamilies" 
swipe-right-to-page 
ng-attr-swipe-right-target="none" 
ng-attr-swipe-right-state="tab.productfamilies" 
ng-attr-swipe-right-gesture="swiperight"
swipe-left-to-page 
ng-attr-swipe-left-target="none" 
ng-attr-swipe-left-state="tab.dash" 
ng-attr-swipe-left-gesture="swipeleft" 
>
<ion-content class="padding" scroll="false">
<div class="page_content product_family_page">
	  

	
<div class="row row-up">

    <div class="col col-67">
  	<ion-content 
	class="col-1 gridListdemoBasicUsage" 
	scroll="false">
	
	
				      <script>
				        // 2. This code loads the IFrame Player API code asynchronously.

				        // 3. This function creates an <iframe> (and YouTube player)
				        //    after the API code downloads.
	
	
						/*
						
						
				        function onYouTubeIframeAPIReady() {
							
							var array_of_iframes = [];
							// array_of_iframes.push('d1zeF2_1KWU');
							array_of_iframes.push('ETmC3jkDAwY');
						
							array_of_iframes.push('pXFI4_TphM4');
							array_of_iframes.push('ip9J8rfxbgA');
							array_of_iframes.push('g-LlBxk0-Gg');
						
							console.log('array_of_iframes ->');
							console.log(array_of_iframes);
						
							// player_{{$index}}
					        // var window['player_'+i];

							for (var i = 0, len = array_of_iframes.length; i < len; i++) {
								
	  				          window['player_'+i] = new YT.Player('player_'+i, {
							  
	  				            height: '155%',
	  				            width: '155%',
	      playerVars: { 'autoplay': 1, 'controls': 0, 'loop':1, rel: 0 },
							  
	  				            // videoId: 'Ora35AzLxt0',
	  				            videoId: array_of_iframes[i],
	  				            events: {
									'onReady': onPlayerReady,
									'onStateChange': onPlayerStateChange
	  				            }
	  				          });
								
							  // someFn(arr[i]);
	  						  $('#player_'+i).css({'opacity':0});
							  
							  
							}
							
				        } // onYouTubeIframeAPIReady
						
			
						
						function replayVideo() {
							
						}

				        // 4. The API will call this function when the video player is ready.
				        function onPlayerReady(event) {
				          // event.target.playVideo();
						  
  						var array_of_iframes = [];
  						// array_of_iframes.push('d1zeF2_1KWU');
						array_of_iframes.push('ETmC3jkDAwY');
  						array_of_iframes.push('pXFI4_TphM4');
  						array_of_iframes.push('ip9J8rfxbgA');
  						array_of_iframes.push('g-LlBxk0-Gg');
						
						event.target.mute();
						event.target.setLoop(true);
						  
						  
						// for (var i = 0, len = array_of_iframes.length; i < len; i++) {
						//
						//   						  // event.target.loadPlaylist(array_of_iframes[i]);
						//   						  //   				          event.target.mute();
						//   						  // event.target.setLoop(true);
						//
						//
						//   // window['player_'+i].loadPlaylist(array_of_iframes[i]);
						//   window['player_'+i].mute();
						//   window['player_'+i].setLoop(true);
						//
						//
						// }
						
						
				        } // player.loadPlaylist


				        // 5. The API calls this function when the player's state changes.
				        //    The function indicates that when playing a video (state=1),
				        //    the player should play for six seconds and then stop.
				        var done = false;
				        function onPlayerStateChange(event) {
				          if (event.data == YT.PlayerState.PLAYING) {
				            // setTimeout(stopVideo, 4000);
							console.log('event.target ->');
							console.log(event.target.c);
							
							event.target.c.style.opacity = '1';
							event.target.setLoop(true);
							
							//
							// for (var i = 0, len = array_of_iframes.length; i < len; i++) {
							//
							//     				        setTimeout(function(){
							//     							// $(".iframevideocontainer").css({'opacity':'0'});
							//     							// $(".iframevideocontainer").css({'opacity':'1'});
							//     							$('#player_'+i).css({'opacity':1});
							//     				        }, 4000);
						  
						// }
							
							
				            // done = true;
				          }
						  
				          if (event.data == YT.PlayerState.ENDED) {
  					        event.target.playVideo();
							event.target.c.style.opacity = '1';
							event.target.setLoop(true);
				          }
						  
				          if (event.data == YT.PlayerState.BUFFERING) {
							event.target.c.style.opacity = '0';
				          }
						  
				        }
						
							// 	function stopVideo() {
							// for (var i = 0, len = array_of_iframes.length; i < len; i++) {
							//
							// window['player_'+i].seekTo(1,true);
							//
							//
							// }
							//
							// 				          // player.stopVideo();
							// 				          // player.seekTo(1,true);
							// 						  // player.playVideo();
							// 				        }
						
						// var recurse = function(steps, delay) {
						//     if(steps == 0) {
						//         // console.log(data.length)
						//     } else {
						//         setTimeout(function(){
						//             recurse(stopVideo());
						// 			// $(".iframevideocontainer").css({'opacity':'0'});
						// 			// $(".iframevideocontainer").css({'opacity':'1'});
						//         }, 4000);
						//     }
						// };

						// recurse(1000, 4000);
	
						
						*/
						
				      </script>
		
		<md-content>	
			
			<md-grid-list
	        md-cols-sm="{{md_cols_gt_lg}}" 
			md-cols-gt-lg="{{md_cols_gt_lg}}"

			md-row-height-sm="fit"
			md-row-height-gt-lg="fit"
		
			md-gutter="0px"
			>

				<md-grid-tile 
				class="gray product_card" 
				ng-repeat="product in Products | object2Array | orderBy:'Order' track by $index" 
				style="background-image:url(img/products/cards/{{product.id}}.jpg);" 
				id="tabs2" ng-if="product.Product">
				<!-- CAREFUL !
					
					 ng-if="product.Product" IS A VERY BIZARRE HACK, NECESSARY FOR IONIC CACHING SYSTEM
					
				- EOF - CAREFUL ! -->
				
				
				
				
<!-- IFRAME YOUTUBE VIDEOS
				
					YOUTUBE VIDEOS HAVE TO BE POSITIONED IN IFRAMES TO AVOID DISPLAYING OF ADS ON THE BOTTOM, AND OTHER "USELESS" STUFF FOR PURELY DECORATIVE VIDEOS. A DECORATIVE VIDEO IS AUTOMATICALLY PLAYED, PLAYS IN LOOP, AND CANNOT BE STOPPED.
					THE HACK HERE IS TO :
					1 - PUT IFRAME IN <ion-content>
					2 - DISABLE SCROLL ON ion-content -> scroll="false"	
				
					THIS IS TO AVOID IFRAME TO BE SCROLLABLE, SINCE THE IFRAME OR VIDEO SIZE IS GOING TO EXCEED THE CONTAINER'S SIZE.
				
					BUT BY DISABLING THE SCROLL ON ion-content, THE EVENT IS PROBABLY PREVENTED TO BUBBLED UP TO col-2 (SEE ABOVE)
-->
				
				
				<div class="card_overlay " ui-sref="tab.products({prodFamID: selectedProdFamID, productID: product.id})">

<!-- COMMENTED_OUT
					{{product.id}}
- EOF - COMMENTED_OUT -->

					
						<h2
						class="centered"
						ng-bind-html="product.Product | translate"
						front-office-edit="product.Product" 
						ng-attr-stringid="{{product.ProductString_ID}}" 
						ng-attr-stringname="{{product.Product}}" 
						></h2>
							
						<div class="short_text centered"
						ng-bind-html="product.ShortDescription | translate"
						></div>
				</div>

				
				
					<ion-content 
						scroll="false" 
						class="iframevideocontainer">
						
					

				  <!-- 1. The <iframe> (and video player) will replace this <div> tag. -->
<!-- COMMENTED_OUT
				      <div id="player_{{$index}}" class="iframevideo_target"></div>
- EOF - COMMENTED_OUT -->

<!-- WORKING ANGULAR YOUTUBE DIRECTIVE
  					<youtube-video video-id="product.youtube_url" class="iframevideo_target" player-vars="playerVars" player-width="'155%'" player-height="'155%'"></youtube-video>
- EOF - WORKING ANGULAR YOUTUBE DIRECTIVE -->

					  
				      		
							
							
							
					
<!-- GOGGLE MAPS WORKING
					<map center="48.804865,2.120355" zoom="16"></map>
- EOF - GOGGLE MAPS WORKING -->
						
					
					
					</ion-content>
				
				
					<md-grid-tile-footer>
				
							<h3 
							ng-bind-html="product.Product | translate"
							front-office-edit="product.Product" 
							ng-attr-stringid="{{product.ProductString_ID}}" 
							ng-attr-stringname="{{product.Product}}" 
							></h3>
						
<!-- COMMENTED_OUT
							<div class="short_text"
							ng-bind-html="'blablalba'"></div>
- EOF - COMMENTED_OUT -->
				
					</md-grid-tile-footer>
				
				</md-grid-tile>

			</md-grid-list>
		</md-content>	
			
  	</ion-content>
  	</div>
		
		
		
		
		
		
		
		
		
  	<div class="col col-33">
			
<!-- DO NOT DELETE : EXAMPLE OF STICKY INNER TOPNAV, FOR SECONDARY ACTIONS
  			<div style="
  			float:right;
  			background:black;
  			height:2rem;
  			width:2rem;
  			padding:0;
  			margin:0;
  			z-index:300;
  			">
  				 2b
  			</div>
- EOF - O NOT DELETE : EXAMPLE OF STICKY INNER TOPNAV, FOR SECONDARY ACTIONS -->

		<ion-content class="col-2 md-whiteframe-z2" scroll="false">
		
		
			
<!-- ANGULAR MATERIAL LIST (SEE HOW MUCH NEEDS TO BE REFACTORED)
			    <md-list>
			      <md-subheader class="md-no-sticky">3 line item</md-subheader>
			      <md-item class="md-3-line" ng-repeat="item in Services | object2Array | orderBy:'Order'">
			        <img ng-src="{{item.face}}?{{$index}}" class="md-avatar" alt="{{item.who}}" />
			        <div class="md-item-text">
			          <h3>test{{ item.who }}</h3>
			          <h4>test{{ item.what }}</h4>
			          <p>test{{ item.notes }}</p>
			        </div>
			    </md-list>
- EOF - ANGULAR MATERIAL LIST (SEE HOW MUCH NEEDS TO BE REFACTORED) -->
				
				
<!-- IONIC LIST
				<ul class="list">
				    <li class="item" ng-repeat="service in Services | object2Array | orderBy:'Order'">
				      {{service.Service | translate}}
				    </li>
				</ul>
- EOF - IONIC LIST -->
				
			
			
  				
			<div class="right_col_flex_rows">
				<div>
<!-- DEBUG, LEAVE IN PLACE
					selectedProdFamID is currently {{selectedProdFamID}}
					<br>
					below is test-directive
					<br>
					<div test-directive></div>
- EOF - DEBUG, LEAVE IN PLACE -->
					
					<h4
					ng-bind-html="section.title | translate" 
					front-office-edit="section.title" 
					ng-attr-stringid="{{section.title_stringid}}" 
					ng-attr-stringname="{{section.title}}" 
					></h4>
				</div>
			</div>
			
			<div class="right_col_flex_rows">
				<p
				ng-bind-html="section.text | translate" 
				front-office-edit="section.text"
				></p>
			</div>
			
			
			<div class="demo">
			<div class="bottom_nav">
				
				<md-button class="md-icon-button" ng-class="{'md-primary': editMode === false, 'md-accent': editMode === true}" aria-label="Edit"  on-tap="toggleEditMode()">
					<md-tooltip>
					          Éditer
					</md-tooltip>
				    <md-icon ng-class="{'ion-locked': editMode === false, 'ion-edit': editMode === true}"></md-icon>
				</md-button>
				
				<md-button class="md-icon-button" ng-class="{'md-primary': iframesStatus === false, 'md-accent': iframesStatus === true}" aria-label="Edit"  on-tap="iframesStatus = !iframesStatus; hide_iframes(iframesStatus);">
					<md-tooltip>
					          Vidéos
					</md-tooltip>
				    <md-icon ng-class="{'ion-play': iframesStatus === false, 'ion-stop': iframesStatus === true}"></md-icon>
				</md-button>
				
			</div>
			</div>

				
  		</ion-content>
  	</div>
	
	
	
	
  	</div>


</div>
</ion-content>
</ion-view>
